<?phpnamespace Admin\Model;use Think\Model;class AreaModel extends Model{    protected  $_validate=array(        array('name','require','名称必须！'),        array('city_id','require','请选择城市！'),    );    protected function _after_select(&$resultSet, $options) {        foreach($resultSet as &$result)        {            if(false===$this->_after_find($result, $options))            {                return false;            }        }    }    protected function _after_find(&$result, $options) {                $result['cname']=M('City')->getFieldById($result['city_id'],'name');    }    protected function _before_delete($options) {        $ids    = $this->where($options['where'])->getField('id,id,name');        $School  = M('School');        foreach ($ids as $id=>$field)        {            $map['area_id']=$id;            if($School->where($map)->count())            {                $this->error=$field['name'].'中存在学校';                return false;            }                    }    }   }